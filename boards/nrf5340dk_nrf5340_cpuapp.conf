# SPDX-License-Identifier: Apache-2.0
# Enable MPU
CONFIG_ARM_MPU=y

# Enable hardware stack protection
CONFIG_HW_STACK_PROTECTION=y

# Enable TrustZone-M
CONFIG_ARM_TRUSTZONE_M=y

# enable GPIO
CONFIG_GPIO=y

# Enable uart driver
CONFIG_SERIAL=n

# NanoPB
CONFIG_NANOPB=y

# enable console
CONFIG_CONSOLE=n
CONFIG_UART_CONSOLE=n

# Need this when storage is on flash
CONFIG_MPU_ALLOW_FLASH_WRITE=y
CONFIG_PM_EXTERNAL_FLASH_MCUBOOT_SECONDARY=y

CONFIG_NRF53_UPGRADE_NETWORK_CORE=y
CONFIG_BOOT_IMAGE_ACCESS_HOOKS=y
CONFIG_NCS_SAMPLE_MCUMGR_BT_OTA_DFU=y
CONFIG_DFU_MULTI_IMAGE=y

# Need this when storage is on MX25R64
CONFIG_NORDIC_QSPI_NOR=y
CONFIG_NORDIC_QSPI_NOR_FLASH_LAYOUT_PAGE_SIZE=4096
CONFIG_NORDIC_QSPI_NOR_STACK_WRITE_BUFFER_SIZE=256

# Additional BLE configurations to fix D2D subscription issues
# Increase ATT prepare count for primary device to handle more subscriptions
# The primary device needs to subscribe to 9 characteristics from secondary device
CONFIG_BT_ATT_PREPARE_COUNT=12

# Increase L2CAP TX buffer count for better throughput
CONFIG_BT_L2CAP_TX_BUF_COUNT=24

# Increase the number of TX buffers
CONFIG_BT_CONN_TX_MAX=30

# Increase RX buffer count for subscriptions
CONFIG_BT_BUF_ACL_RX_COUNT_EXTRA=15

# Increase maximum connections to support more subscriptions
# Total subscriptions = CONFIG_BT_MAX_CONN + CONFIG_BT_MAX_PAIRED
# We need at least 9 for D2D characteristics, so 5 + 4 = 9
CONFIG_BT_MAX_CONN=16