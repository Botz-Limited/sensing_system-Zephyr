/**
 * @file crc32.cpp
 * @brief
 * @version 1.0
 * @date 15/5/2025
 *
 * @copyright Botz Innovation 2025
 *
 */


/**
 *****************************************************************************************************************************************************
 *  \section INCLUDE FILES
 *****************************************************************************************************************************************************
 */
#include <crc32.hpp>

#include <stdlib.h>


/**
 *****************************************************************************************************************************************************
 *  \section LOCAL DEFINITIONS/MACROS
 *****************************************************************************************************************************************************
 */


/**
 *****************************************************************************************************************************************************
 *  \section STATIC FUNCTION PROTOTYPES
 *****************************************************************************************************************************************************
 */


/**
 *****************************************************************************************************************************************************
 *  \section STATIC VARIABLES
 *****************************************************************************************************************************************************
 */


/**
 *****************************************************************************************************************************************************
 *  \section GLOBAL VARIABLES
 *****************************************************************************************************************************************************
 */


/**
 *****************************************************************************************************************************************************
 *  \section SOURCE CODE
 *****************************************************************************************************************************************************
 */
/**
 *****************************************************************************************************************************************************
 *  @brief  Computes the crc32 checksum for a given buffer
 *  @param  [in]  p_data - The input data block for computation.
 *  @param  [in]  size - The size of the input data block in bytes.
 *  @param  [in]  p_crc - The previous calculated CRC-32 value or NULL if first call
 *  @return The updated CRC-32 value, based on the input supplied.
 *****************************************************************************************************************************************************
 */
uint32_t CRC32_Compute(uint8_t const* p_data, uint32_t size, uint32_t const* p_crc)
{
    uint32_t crc;

    crc = (p_crc == NULL) ? 0xFFFFFFFF : ~(*p_crc);
    for (uint32_t i = 0; i < size; i++)
    {
        crc = crc ^ p_data[i];
        for (uint32_t j = 8; j > 0; j--)
        {
            crc = (crc >> 1) ^ (0xEDB88320U & ((crc & 1) ? 0xFFFFFFFF : 0));
        }
    }
    return ~crc;
}


/**
 *****************************************************************************************************************************************************
 *  END OF FILE
 *****************************************************************************************************************************************************
 */

